-- ä½ç½®: Samurai Boss -> Script (é‡å‘½åä¸º AI)
-- âš ï¸ é‡è¦ï¼šåœ¨å±æ€§é¢æ¿é‡ŒæŠŠè¿™ä¸ªè„šæœ¬çš„ Enabled å–æ¶ˆå‹¾é€‰ï¼
local boss = script.Parent
local humanoid = boss:WaitForChild("Humanoid")
local root = boss:WaitForChild("HumanoidRootPart")

-- æ”»å‡»å‚æ•°
local ATTACK_RANGE = 80 -- ç´¢æ•ŒèŒƒå›´ (æ”¹å¤§ç‚¹ï¼Œé˜²æ­¢ç©å®¶è·‘å¤ªè¿œå®ƒå‘å‘†)
local STOP_RANGE = 4    -- åœæ­¢è·ç¦» (é˜²æ­¢è´´è„¸ç©¿æ¨¡)
local DAMAGE = 20
local ATTACK_COOLDOWN = 1.5

local lastAttack = 0

print("ğŸ¤– Boss AI å·²å¯åŠ¨ï¼")

while task.wait(0.1) do
	local target = nil
	local shortestDist = ATTACK_RANGE

	-- å¯»æ‰¾æœ€è¿‘çš„ç©å®¶
	for _, player in pairs(game.Players:GetPlayers()) do
		if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
			local char = player.Character
			local dist = (root.Position - char.HumanoidRootPart.Position).Magnitude

			-- å¿…é¡»åœ¨èŒƒå›´å†…ï¼Œä¸”ç©å®¶æ´»ç€
			if dist < shortestDist and char.Humanoid.Health > 0 then
				shortestDist = dist
				target = char
			end
		end
	end

	if target then
		-- 1. ç§»åŠ¨å‘ç©å®¶
		if shortestDist > STOP_RANGE then
			humanoid:MoveTo(target.HumanoidRootPart.Position)
		else
			-- è·ç¦»å¤Ÿè¿‘äº†ï¼Œåœä¸‹æ”»å‡»
			humanoid:MoveTo(root.Position)
		end

		-- 2. æ”»å‡»åˆ¤æ–­ (ç®€å•è§¦ç¢°æˆ–è·ç¦»åˆ¤æ–­)
		if shortestDist <= 6 and os.clock() - lastAttack > ATTACK_COOLDOWN then
			lastAttack = os.clock()

			-- é€ æˆä¼¤å®³
			target.Humanoid:TakeDamage(DAMAGE)
			print("âš”ï¸ Boss æ”»å‡»äº† " .. target.Name)

			-- å¯é€‰ï¼šè¿™é‡Œå¯ä»¥æ’­æ”¾æ”»å‡»åŠ¨ç”»
		end
	else
		-- æ²¡ç›®æ ‡ï¼Œåœåœ¨åŸåœ°
		humanoid:MoveTo(root.Position)
	end
end
--local Players = game:GetService("Players")
--local ReplicatedStorage = game:GetService("ReplicatedStorage")
--local UserInputService = game:GetService("UserInputService")
--local GuiService = game:GetService("GuiService")

--local player = Players.LocalPlayer
--local playerGui = player:WaitForChild("PlayerGui")
--local GameConfig = require(ReplicatedStorage:WaitForChild("GameConfig"))

---- åŠ¨æ€ UI å¼•ç”¨
--local scrollingFrame = nil

--print("ğŸ” [InventoryController] è„šæœ¬å¯åŠ¨ï¼Œå¼€å§‹å¯»æ‰¾ UI...")

---- ==========================================
---- 1. å¯»æ‰¾å®¹å™¨ (å¢å¼ºç‰ˆï¼šå¸¦ç­‰å¾…å’ŒæŠ¥é”™)
---- ==========================================
--local function findContainer()
--	-- 1. æ‰¾ ScreenGui
--	local inventoryGui = playerGui:WaitForChild("InventoryGui", 5)
--	if not inventoryGui then
--		warn("âŒ [InventoryController] æ‰¾ä¸åˆ° InventoryGuiï¼UI ç”Ÿæˆå™¨å¯èƒ½æœªè¿è¡Œã€‚")
--		return nil
--	end

--	-- 2. æ‰¾ MainFrame
--	local mainFrame = inventoryGui:WaitForChild("MainFrame", 5)
--	if not mainFrame then
--		warn("âŒ [InventoryController] æ‰¾ä¸åˆ° MainFrameï¼ç»“æ„å¯èƒ½ä¸å¯¹ã€‚")
--		return nil
--	end

--	-- 3. æ‰¾ Container
--	local container = mainFrame:WaitForChild("Container", 5)
--	if not container then
--		warn("âŒ [InventoryController] æ‰¾ä¸åˆ° Containerï¼æ»šåŠ¨æ¡†å»å“ªäº†ï¼Ÿ")
--		return nil
--	end

--	return container
--end

---- ==========================================
---- 2. æ›´æ–°å¼•ç”¨
---- ==========================================
--local function updateUIReference()
--	local container = findContainer()
--	if container then
--		if scrollingFrame ~= container then
--			print("âœ… [InventoryController] æˆåŠŸè¿æ¥åˆ°èƒŒåŒ…å®¹å™¨: ", container:GetFullName())
--			scrollingFrame = container
--		end
--		return true
--	else
--		scrollingFrame = nil
--		return false
--	end
--end

---- ==========================================
---- 3. è£…å¤‡é€»è¾‘
---- ==========================================
--local function toggleEquipItem(itemName)
--	local backpack = player:WaitForChild("Backpack")
--	local character = player.Character
--	local humanoid = character and character:FindFirstChild("Humanoid")
--	if not humanoid then return false end

--	local heldTool = character:FindFirstChild(itemName)
--	if heldTool then
--		heldTool.Parent = backpack
--		return false
--	end

--	local tool = backpack:FindFirstChild(itemName)
--	if tool then
--		humanoid:EquipTool(tool)
--		return true
--	end
--	return false
--end

---- ==========================================
---- 4. åˆ·æ–°ç•Œé¢ (æ ¸å¿ƒé€»è¾‘)
---- ==========================================
--local function updateInventoryUI()
--	-- 1. æ£€æŸ¥å¼•ç”¨
--	if not updateUIReference() then 
--		warn("âš ï¸ [InventoryController] æ— æ³•åˆ·æ–°ï¼šæ²¡æœ‰ UI å¼•ç”¨")
--		return 
--	end

--	-- 2. æ¸…ç†æ—§å›¾æ ‡ (ä¿ç•™ Layout)
--	for _, child in pairs(scrollingFrame:GetChildren()) do
--		if child:IsA("ImageButton") then child:Destroy() end
--	end

--	-- 3. è¯»å–æ•°æ®
--	local invFolder = player:FindFirstChild("Inventory")
--	if not invFolder then 
--		warn("âš ï¸ [InventoryController] ç©å®¶è¿˜æ²¡æœ‰ Inventory æ–‡ä»¶å¤¹ï¼")
--		return 
--	end

--	local items = invFolder:GetChildren()
--	if #items == 0 then
--		print("â„¹ï¸ [InventoryController] èƒŒåŒ…æ˜¯ç©ºçš„ (Inventory æ–‡ä»¶å¤¹é‡Œæ²¡ä¸œè¥¿)")
--		-- å¯ä»¥åœ¨è¿™é‡Œæ˜¾ç¤ºä¸€ä¸ª "Empty" çš„æç¤ºæ–‡æœ¬
--	end

--	-- 4. åˆ›å»ºå›¾æ ‡
--	for _, itemVal in ipairs(items) do
--		local itemName = itemVal.Name

--		-- å®‰å…¨è·å–é…ç½®ï¼Œé˜²æ­¢æŠ¥é”™ä¸­æ–­
--		local conf = nil
--		if GameConfig.Weapons then conf = GameConfig.Weapons[itemName] end
--		if not conf and GameConfig.Items then conf = GameConfig.Items[itemName] end

--		-- å³ä½¿æ²¡é…ç½®ä¹Ÿåˆ›å»ºæŒ‰é’®ï¼Œæ–¹ä¾¿è°ƒè¯•
--		local card = Instance.new("ImageButton")
--		card.Name = itemName
--		card.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
--		card.Parent = scrollingFrame
--		Instance.new("UICorner", card).CornerRadius = UDim.new(0.1, 0)

--		local icon = Instance.new("ImageLabel")
--		icon.Size = UDim2.new(0.8, 0, 0.8, 0)
--		icon.Position = UDim2.new(0.1, 0, 0.1, 0)
--		icon.BackgroundTransparency = 1
--		icon.Image = conf and conf.ImageId or "rbxasset://textures/ui/GuiImagePlaceholder.png"
--		icon.Parent = card

--		-- æ•°é‡
--		if itemVal.Value > 1 then
--			local qty = Instance.new("TextLabel")
--			qty.Size = UDim2.new(0.4, 0, 0.3, 0)
--			qty.Position = UDim2.new(0.6, 0, 0.7, 0)
--			qty.BackgroundTransparency = 1
--			qty.TextColor3 = Color3.new(1,1,1)
--			qty.Font = Enum.Font.FredokaOne
--			qty.TextSize = 14
--			qty.Text = "x"..itemVal.Value
--			qty.Parent = card
--		end

--		-- è£…å¤‡çŠ¶æ€ E
--		local equipStatus = Instance.new("TextLabel")
--		equipStatus.Size = UDim2.new(0.3, 0, 0.3, 0)
--		equipStatus.Position = UDim2.new(0, 5, 0, 5)
--		equipStatus.BackgroundTransparency = 1
--		equipStatus.TextColor3 = Color3.fromRGB(0, 255, 100)
--		equipStatus.Font = Enum.Font.FredokaOne
--		equipStatus.TextSize = 18
--		equipStatus.Text = "E"
--		equipStatus.Visible = false
--		equipStatus.Parent = card

--		if player.Character and player.Character:FindFirstChild(itemName) then
--			card.BackgroundColor3 = Color3.fromRGB(60, 80, 60)
--			card.BorderSizePixel = 2
--			card.BorderColor3 = Color3.fromRGB(0, 255, 0)
--			equipStatus.Visible = true
--		end

--		card.MouseButton1Click:Connect(function()
--			local isEquipped = toggleEquipItem(itemName)
--			if isEquipped then
--				card.BackgroundColor3 = Color3.fromRGB(60, 80, 60)
--				card.BorderSizePixel = 2
--				card.BorderColor3 = Color3.fromRGB(0, 255, 0)
--				equipStatus.Visible = true
--			else
--				card.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
--				card.BorderSizePixel = 0
--				equipStatus.Visible = false
--			end
--			-- å»¶æ—¶ä¸€ç‚¹åˆ·æ–°ä»¥ä¿è¯çŠ¶æ€åŒæ­¥
--			task.delay(0.1, updateInventoryUI)
--		end)
--	end

--	print("âœ… [InventoryController] åˆ·æ–°å®Œæ¯•ï¼Œæ˜¾ç¤ºäº† " .. #items .. " ä¸ªç‰©å“")
--end

---- ==========================================
---- 5. ç›‘å¬
---- ==========================================
---- ç›‘å¬ UI é‡å»º (é’ˆå¯¹ UI ç”Ÿæˆå™¨å¯èƒ½ä¼šé”€æ¯é‡å»ºçš„æƒ…å†µ)
--playerGui.ChildAdded:Connect(function(child)
--	if child.Name == "InventoryGui" then
--		print("ğŸ”„ [InventoryController] æ£€æµ‹åˆ° UI é‡å»ºï¼Œå°è¯•é‡æ–°è¿æ¥...")
--		task.wait(0.5) -- ç­‰å¾…å­ç»„ä»¶åŠ è½½
--		updateInventoryUI()
--	end
--end)

---- ç›‘å¬æ•°æ®
--if player:FindFirstChild("Inventory") then
--	player.Inventory.ChildAdded:Connect(updateInventoryUI)
--	player.Inventory.ChildRemoved:Connect(updateInventoryUI)
--	for _, c in pairs(player.Inventory:GetChildren()) do
--		c.Changed:Connect(updateInventoryUI)
--	end
--else
--	warn("âš ï¸ [InventoryController] åˆå§‹æœªæ‰¾åˆ° Inventory æ–‡ä»¶å¤¹ï¼Œç­‰å¾… PlayerAdded å¤„ç†...")
--	player.ChildAdded:Connect(function(c)
--		if c.Name == "Inventory" then
--			print("âœ… [InventoryController] Inventory æ–‡ä»¶å¤¹å·²åŠ è½½")
--			c.ChildAdded:Connect(updateInventoryUI)
--			c.ChildRemoved:Connect(updateInventoryUI)
--			updateInventoryUI()
--		end
--	end)
--end

--local function bindChar(char)
--	char.ChildAdded:Connect(function(c) if c:IsA("Tool") then updateInventoryUI() end end)
--	char.ChildRemoved:Connect(function(c) if c:IsA("Tool") then updateInventoryUI() end end)
--end
--if player.Character then bindChar(player.Character) end
--player.CharacterAdded:Connect(bindChar)

---- å¯åŠ¨
--task.wait(1)
--updateInventoryUI()